<HTML><TITLE>FDT - FMRIB's Diffusion Toolbox - User Guide</TITLE>
<BODY BACKGROUND="fdt_images/fsl-bg.jpg">
<h3>Registration of vector images using vecreg</h3>

<p>

<IMG ALIGN=RIGHT height=200 SRC="fdt_images/fdt_vecreg.gif"
ALT="vecreg applied to V1">  
After running dtifit or bedpost, it is often useful to register vector data to another space. For example, one might want to represent V1 for different subjects in standard space. <b>vecreg</b> is a command line tool that allows to perform such registration.<br>
Vector images cannot be registered by simply applying a transformation (as calculated by, say, flirt) to every voxel's coordinates. The corresponding vectors have to be reoriented accordingly (see D. Alexander 2001, IEEE-TMI 20:1131-1139). vecreg perform this operation for you.
The image shows the effect of applying vecreg (right) to the V1 image on the left, compared to simply apply voxelwise transformation (e.g. using applyxfm4D) to the vectors (centre).
<br><br>
<b> Important: </b> vecreg does not calculate a transformation, but simply applies a given transformation to the input vector field. vecreg can apply a linear transformation calculated with FLIRT, or a non-linear transformation calculated using either IRTK or FNIRT, using a warpfield calculated by dof2warp.

<p>

types of vectors that may be used for vecreg<br>
from dtifit: V1,V2,V3<br>
from bedpost: dyads1, dyads2, etc. <br>

<p>

<h3>Command-line utility</h3>
<b>using a flirt matrix</b><br>
vecreg -i input_vector -o output_vector -r reference_image -t flirt_transform.mat<br>
<b>using a warpfield</b><br>
vecreg -i input_vector -o output_vector -r reference_image -w warp_field<br>
<br>
<b>more options</b><br>

<pre>
Usage: 
vector_flirt -i &lt;input4Dvector&gt; -o &lt;output4D&gt; -t &lt;transformation&gt;

Compulsory arguments (You MUST set one or more of):
        -i,--input      filename of input vector
        -o,--output     filename of output registered vector
        -r,--ref        filename of reference (target) volume

Optional arguments (You may optionally specify one or more of):
        -v,--verbose    switch on diagnostic messages
        -h,--help       display this message
        -t,--affine     filename of affine transformation matrix
        -w,--warpfield  filename of 4D warp field for nonlinear registration
        --interp        interpolation method : nearestneighbour (default) or trilinear or sinc
        -m,--mask       brain mask in input space
</pre>
 
